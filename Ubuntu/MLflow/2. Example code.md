# 1. Example code
- https://github.com/mlflow/mlflow/tree/master/examples/sklearn_elasticnet_diabetes
  ```
  oh@oh-VirtualBox:~/mlflow-tutorial$ wget https://raw.githubusercontent.com/mlflow/mlflow/master/examples/sklearn_elasticnet_diabetes/linux/train_diabetes.py

  --2023-09-15 18:32:36--  https://raw.githubusercontent.com/mlflow/mlflow/master/examples/sklearn_elasticnet_diabetes/linux/train_diabetes.py
  raw.githubusercontent.com (raw.githubusercontent.com) 해석 중... 185.199.108.133, 185.199.110.133, 185.199.109.133, ...
  다음으로 연결 중: raw.githubusercontent.com (raw.githubusercontent.com)|185.199.108.133|:443... 연결했습니다.
  HTTP 요청을 보냈습니다. 응답 기다리는 중... 200 OK
  길이: 4082 (4.0K) [text/plain]
  저장 위치: ‘train_diabetes.py’
  train_diabetes.py   100%[===================>]   3.99K  --.-KB/s    / 0s       
  2023-09-15 18:32:36 (45.9 MB/s) - ‘train_diabetes.py’ 저장함 [4082/4082]
  ```
  - mlflow에서 example로 제공해주는 다양한 example중 하나인 당뇨병 진행도
    - scikit-learn 패키지에서 제공하는 당뇨병 진행도 예측용 데이터로 ElasticNet 모델을 학습 후 예측 한 뒤 evaluation metric을 MLflow에 기록하는 예제
    - parameter : alpha, l1_ratio
    - mlflow와 연관된 부분
      - mlflow.log_param
      - mlflow.log_metric
      - mlflow.log_model
      - mlflow.log_artifact

# 2. Example code 실행
```
oh@oh-VirtualBox:~/mlflow-tutorial$ vi train_diabetes.py

#추가해줘야 에러가 안뜬다.
import mlflow
mlflow.set_tracking_uri('http://127.0.0.1:5000')

oh@oh-VirtualBox:~/mlflow-tutorial$ python3 train_diabetes.py
Elasticnet model (alpha=0.050000, l1_ratio=0.050000):
  RMSE: 78.59249466381223
  MAE: 66.30998032458166
  R2: 0.06607434687959934
Computing regularization path using the elastic net.
```
  - model 관련 meta 정보와 pkl 파일이 저장
    ![image](https://github.com/18-12847/KT_AIVLE_SCHOOL_Study_Backup/assets/118495919/1f6b01e0-504f-4d82-8b4b-be3f35c9ed18)

- 다양한 parameter로 테스트 후 mlflow 확인
  ```
  python train_diabetes.py  0.01 0.01
  python train_diabetes.py  0.01 0.75
  python train_diabetes.py  0.01 1.0
  python train_diabetes.py  0.05 1.0
  python train_diabetes.py  0.05 0.01
  python train_diabetes.py  0.5 0.8
  python train_diabetes.py  0.8 1.0
  ```
  ![image](https://github.com/18-12847/KT_AIVLE_SCHOOL_Study_Backup/assets/118495919/a1b0fd13-db13-494e-80a7-a91452b7dc67)

  ```
  oh@oh-VirtualBox:~/mlflow-tutorial$ cd mlruns/
  oh@oh-VirtualBox:~/mlflow-tutorial/mlruns$ ls
  0  models
  oh@oh-VirtualBox:~/mlflow-tutorial/mlruns$ cd 0
  oh@oh-VirtualBox:~/mlflow-tutorial/mlruns/0$ ls
  08be0c9033fc4ccd9b084a93f05ad2dc  31a675d1ce234165a7e25edd2071ab6c  a3df5d680eaa4e8983787a4c6e55cb20  meta.yaml
  09e33d80f80c481682f471551f1e899f  3453a07477994cd9b1820466c1a85284  b9ea597a822246e0b18588fdb7565806
  2cb62a82ef0446a89812e02541238507  53e0f2332cab43afbe16a9b24de642f8  e21ed0ab57984964b10975761245376d

  oh@oh-VirtualBox:~/mlflow-tutorial/mlruns/0$ cd 31a675d1ce234165a7e25edd2071ab6c
  oh@oh-VirtualBox:~/mlflow-tutorial/mlruns/0/31a675d1ce234165a7e25edd2071ab6c$ ls
  artifacts  meta.yaml  metrics  params  tags

  oh@oh-VirtualBox:~/mlflow-tutorial/mlruns/0/31a675d1ce234165a7e25edd2071ab6c$ cd metrics
  oh@oh-VirtualBox:~/mlflow-tutorial/mlruns/0/31a675d1ce234165a7e25edd2071ab6c/metrics$ ls
  mae  r2  rmse

  oh@oh-VirtualBox:~/mlflow-tutorial/mlruns/0/31a675d1ce234165a7e25edd2071ab6c/metrics$ cat mae
  1694771460952 60.09131524886582 0
  oh@oh-VirtualBox:~/mlflow-tutorial/mlruns/0/31a675d1ce23
  ```
- mlflow에 들어가면 똑같이 저장되어 있는 것을 확인 가능
    ![image](https://github.com/18-12847/KT_AIVLE_SCHOOL_Study_Backup/assets/118495919/55e24e1d-2fae-4629-b13f-2a683189c09b)
